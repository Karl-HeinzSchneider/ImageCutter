addEventListener("message",async m=>{let e=new OffscreenCanvas(100,100),a=new OffscreenCanvas(100,100),h=new FileReaderSync,c=m.data.active,g=m.data.cuts;console.log("process...",g.length,"cut(s),",c);let u=await fetch(c.file.dataURL).then(t=>t.blob()),i=await createImageBitmap(u);a.width=i.width,a.height=i.height,a.getContext("2d").drawImage(i,0,0);let r=[];for(let t=0;t<g.length;t++){let d=g[t],s=d.absolute,n=s.width,o=s.height,f=s.x,p=s.y;e.width=n,e.height=o;let l=e.getContext("2d");l?.clearRect(0,0,n,o),l?.drawImage(a,f,p,n,o,0,0,n,o);let w=await e.convertToBlob({type:"image/png"}),b=h.readAsDataURL(w);r.push({dataURL:b,fileType:"image/png",cut:d})}r.length>0&&postMessage({img:c,result:r})});
